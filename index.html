<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Souqmarine</title>

  <!-- Pi SDK -->
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>

  <script>
    // Initialize Pi SDK (Testnet)
    document.addEventListener("DOMContentLoaded", function () {
      if (window.Pi) {
        Pi.init({
          version: "2.0",
          sandbox: true // ✅ Testnet
        });
        console.log("Pi SDK initialized");
      } else {
        console.log("Pi SDK not found");
      }
    });
  </script>

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 80px;
    }
    button {
      margin-top: 30px;
      padding: 14px 22px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>

<body>

  <h1>Souqmarine</h1>
  <p>Maritime market · Powered by Pi Network</p>

  <button id="payBtn">
    Test Pi Payment (Testnet)
  </button>

  <script>
    document.getElementById("payBtn").addEventListener("click", function () {

      if (!window.Pi) {
        alert("❌ Please open this app inside Pi Browser");
        return;
      }

      // Authenticate first (important)
      Pi.authenticate(
        ["payments"],
        function (auth) {
          console.log("Authenticated:", auth);

          // Create payment
          Pi.createPayment(
            {
              amount: 0.01,
              memo: "Souqmarine Testnet verification"
            },
            {
              onReadyForServerApproval: function (paymentId) {
                console.log("Ready for approval:", paymentId);
              },
              onComplete: function (paymentId, txid) {
                alert("✅ Payment successful");
                console.log("Completed:", paymentId, txid);
              },
              onCancel: function () {
                alert("Payment cancelled");
              },
              onError: function (error) {
                alert("Payment error");
                console.error(error);
              }
            }
          );
        },
        function (error) {
          alert("Authentication failed");
          console.error(error);
        }
      );
    });
  </script>

</body>
</html>
